
<style>
    .preLog {
        font-size: 11px;
        color: inherit;
        border: initial;
        padding: initial;
        font-family: inherit;
        line-height: 1.3;
        user-select: text;
    }
</style>
<script type="application/javascript">

    Homey.setTitle(Homey.__("repair.title.statistics"));
    
</script>

<div>
    <fieldset class="homey-form-fieldset">
        <legend class="homey-form-legend"><span data-i18n="repair.statistics.title_short"></span></legend>
        <table>
            <tr>
                <td>
                    <label class="homey-form-label" for="short.entities" style="margin-top:0px"><span data-i18n="repair.statistics.entities"></span></label>
                </td>
                <td>
                    <label class="homey-form-label" for="short.entitiesAmount" style="margin-top:0px"><span data-i18n="repair.statistics.entities_amount"></span></label>
                </td>
                <td>
                    <label class="homey-form-label" for="short.entityStates" style="margin-top:0px"><span data-i18n="repair.statistics.entity_states"></span></label>
                </td>
                <td>
                    <label class="homey-form-label" for="short.events" style="margin-top:0px"><span data-i18n="repair.statistics.events"></span></label>
                </td>
            </tr>
            <tr>
                <td>
                    <input class="homey-form-input" id="short.entities" type="text" value=""/>
                </td>
                <td>
                    <input class="homey-form-input" id="short.entitiesAmount" type="text" value=""/>
                </td>
                <td>
                    <input class="homey-form-input" id="short.entityStates" type="text" value=""/>
                </td>
                <td>
                    <input class="homey-form-input" id="short.events" type="text" value=""/>
                </td>
            </tr>
        </table>
    </fieldset>
    <fieldset class="homey-form-fieldset"></fieldset>
        <legend class="homey-form-legend"><span data-i18n="repair.statistics.title_sum"></span></legend>
        <table>
            <tr>
                <td>
                    <label class="homey-form-label" for="sum.entities" style="margin-top:0px"><span data-i18n="repair.statistics.entities"></span></label>
                </td>
                <td>
                    <label class="homey-form-label" for="sum.entitiesAmount" style="margin-top:0px"><span data-i18n="repair.statistics.entities_amount"></span></label>
                </td>
                <td>
                    <label class="homey-form-label" for="sum.entityStates" style="margin-top:0px"><span data-i18n="repair.statistics.entity_states"></span></label>
                </td>
                <td>
                    <label class="homey-form-label" for="sum.events" style="margin-top:0px"><span data-i18n="repair.statistics.events"></span></label>
                </td>
            </tr>
            <tr>
                <td>
                    <input class="homey-form-input" id="sum.entities" type="text" value=""/>
                </td>
                <td>
                    <input class="homey-form-input" id="sum.entitiesAmount" type="text" value=""/>
                </td>
                <td>
                    <input class="homey-form-input" id="sum.entityStates" type="text" value=""/>
                </td>
                <td>
                    <input class="homey-form-input" id="sum.events" type="text" value=""/>
                </td>
            </tr>
        </table>
    </fieldset>

    <fieldset class="homey-form-fieldset"></fieldset>
        <div>
            <button id="btnRefresh" class="homey-button-primary-full" onClick="refresh()"><span data-i18n="repair.statistics.refresh"></span></button>
        </div>
    </fieldset>

</div>

<script type="application/javascript">

    function refresh(){
        Homey.emit('getStatistics').then((data) => onStatisticsUpdate(data));
    }

    function onStatisticsUpdate(data){
        let statistics = data;
        if (typeof data == "string"){
            statistics = JSON.parse(data);
        } 
        document.getElementById('short.entities').value = statistics.short.entityUpdates;
        document.getElementById('short.entitiesAmount').value = statistics.short.entityUpdatesElements;
        document.getElementById('short.entityStates').value = statistics.short.entityStates;
        document.getElementById('short.events').value = statistics.short.events;
        document.getElementById('sum.entities').value = statistics.sum.entityUpdates;
        document.getElementById('sum.entitiesAmount').value = statistics.sum.entityUpdatesElements;
        document.getElementById('sum.entityStates').value = statistics.sum.entityStates;
        document.getElementById('sum.events').value = statistics.sum.events;
    }

    Homey.emit('getStatistics').then((data) => onStatisticsUpdate(data));

</script>